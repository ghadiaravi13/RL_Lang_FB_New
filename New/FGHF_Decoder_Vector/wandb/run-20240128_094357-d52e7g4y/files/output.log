
  0%|                                                                                                                                                       | 0/50 [00:00<?, ?it/s]INFO:__main__:[step 0] model checkpoint saved
INFO:__main__:Evaluating [step 0] ...
  torch.tensor(eval_v, device=results['generated_input_ids'].device))                                                                                      | 0/125 [00:00<?, ?it/s]





INFO:__main__:Evaluated [step 0] rewards = 0.5949                                                                                                  | 6/125 [01:29<29:48, 15.03s/it]
INFO:__main__:Best ckpt updated to [step 0]
  0%|                                                                                                                                                       | 0/50 [02:15<?, ?it/s]
Traceback (most recent call last):
  File "/home/jupyter/Ravi_new/RL_Language_Feedback/New/FGHF_Decoder_Vector/tasks/qa_feedback/training/train_finegrained.py", line 280, in <module>
    main()
  File "/home/jupyter/Ravi_new/RL_Language_Feedback/New/FGHF_Decoder_Vector/tasks/qa_feedback/training/train_finegrained.py", line 271, in main
    trainer.train(step)
  File "/home/jupyter/Ravi_new/RL_Language_Feedback/New/FGHF_Decoder_Vector/fgrlhf/ppo.py", line 366, in train
    init_head_wt_0 = self.accelerator.unwrap_model(self.policy_model).dec_v0_wt
  File "/home/jupyter/Ravi_new/.conda/envs/fghf_py39/lib/python3.9/site-packages/accelerate/accelerator.py", line 1499, in unwrap_model
    return extract_model_from_parallel(model, keep_fp32_wrapper)
  File "/home/jupyter/Ravi_new/.conda/envs/fghf_py39/lib/python3.9/site-packages/accelerate/utils/other.py", line 54, in extract_model_from_parallel
    forward = getattr(model, "forward")
AttributeError: 'T5Policy' object has no attribute 'forward'
Traceback (most recent call last):
  File "/home/jupyter/Ravi_new/RL_Language_Feedback/New/FGHF_Decoder_Vector/tasks/qa_feedback/training/train_finegrained.py", line 280, in <module>
    main()
  File "/home/jupyter/Ravi_new/RL_Language_Feedback/New/FGHF_Decoder_Vector/tasks/qa_feedback/training/train_finegrained.py", line 271, in main
    trainer.train(step)
  File "/home/jupyter/Ravi_new/RL_Language_Feedback/New/FGHF_Decoder_Vector/fgrlhf/ppo.py", line 366, in train
    init_head_wt_0 = self.accelerator.unwrap_model(self.policy_model).dec_v0_wt
  File "/home/jupyter/Ravi_new/.conda/envs/fghf_py39/lib/python3.9/site-packages/accelerate/accelerator.py", line 1499, in unwrap_model
    return extract_model_from_parallel(model, keep_fp32_wrapper)
  File "/home/jupyter/Ravi_new/.conda/envs/fghf_py39/lib/python3.9/site-packages/accelerate/utils/other.py", line 54, in extract_model_from_parallel
    forward = getattr(model, "forward")
AttributeError: 'T5Policy' object has no attribute 'forward'