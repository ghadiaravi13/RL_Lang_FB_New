
  0%|                                                                                                                                                       | 0/50 [00:00<?, ?it/s]INFO:__main__:[step 0] model checkpoint saved
INFO:__main__:Evaluating [step 0] ...
  torch.tensor(eval_v, device=results['generated_input_ids'].device))                                                                                      | 0/250 [00:00<?, ?it/s]





INFO:__main__:Evaluated [step 0] rewards = 0.3670                                                                                                  | 6/250 [01:15<55:39, 13.69s/it]
INFO:__main__:Best ckpt updated to [step 0]
/home/jupyter/Ravi_new/RL_Language_Feedback/New/FineGrainedRLHF/fgrlhf/ppo.py:373: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  lm_head_kl_div_0_1 = torch.nn.KLDivLoss()(F.log_softmax(softmaxed_wt_0), softmaxed_wt_1)
/home/jupyter/Ravi_new/.conda/envs/fghf_py39/lib/python3.9/site-packages/torch/nn/functional.py:2916: UserWarning: reduction: 'mean' divides the total loss by both the batch size and the support size.'batchmean' divides only by the batch size, and aligns with the KL div math definition.'mean' will be changed to behave the same as 'batchmean' in the next major release.
  warnings.warn(
/home/jupyter/Ravi_new/RL_Language_Feedback/New/FineGrainedRLHF/fgrlhf/ppo.py:374: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  lm_head_kl_div_1_2 = torch.nn.KLDivLoss()(F.log_softmax(softmaxed_wt_1), softmaxed_wt_2)
/home/jupyter/Ravi_new/RL_Language_Feedback/New/FineGrainedRLHF/fgrlhf/ppo.py:375: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  lm_head_kl_div_0_2 = torch.nn.KLDivLoss()(F.log_softmax(softmaxed_wt_0), softmaxed_wt_2)




 10%|██████████████▎                                                                                                                                | 5/50 [04:09<30:22, 40.49s/it]INFO:__main__:[step 5] model checkpoint saved
INFO:__main__:Evaluating [step 5] ...







INFO:__main__:Evaluated [step 5] rewards = 0.5529                                                                                                  | 6/250 [01:19<55:47, 13.72s/it]
INFO:__main__:Best ckpt updated to [step 5]




 20%|████████████████████████████▍                                                                                                                 | 10/50 [08:49<28:12, 42.31s/it]INFO:__main__:[step 10] model checkpoint saved
INFO:__main__:Evaluating [step 10] ...






INFO:__main__:Evaluated [step 10] rewards = 0.3697                                                                                                 | 6/250 [01:18<55:58, 13.76s/it]




 30%|██████████████████████████████████████████▌                                                                                                   | 15/50 [13:21<24:59, 42.84s/it]INFO:__main__:[step 15] model checkpoint saved
INFO:__main__:Evaluating [step 15] ...






INFO:__main__:Evaluated [step 15] rewards = 0.1908                                                                                                 | 6/250 [01:16<55:08, 13.56s/it]




 40%|████████████████████████████████████████████████████████▊                                                                                     | 20/50 [17:53<21:49, 43.66s/it]INFO:__main__:[step 20] model checkpoint saved
INFO:__main__:Evaluating [step 20] ...






INFO:__main__:Evaluated [step 20] rewards = 0.3242                                                                                                 | 6/250 [01:21<58:14, 14.32s/it]




 50%|███████████████████████████████████████████████████████████████████████                                                                       | 25/50 [22:08<17:11, 41.27s/it]INFO:__main__:[step 25] model checkpoint saved
INFO:__main__:Evaluating [step 25] ...






INFO:__main__:Evaluated [step 25] rewards = 0.3083                                                                                                 | 6/250 [01:21<58:30, 14.39s/it]




 60%|█████████████████████████████████████████████████████████████████████████████████████▏                                                        | 30/50 [26:30<13:37, 40.87s/it]INFO:__main__:[step 30] model checkpoint saved
INFO:__main__:Evaluating [step 30] ...







INFO:__main__:Evaluated [step 30] rewards = 0.6812                                                                                               | 6/250 [01:24<1:04:59, 15.98s/it]
INFO:__main__:Best ckpt updated to [step 30]




 70%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                          | 35/50 [30:54<09:56, 39.75s/it]INFO:__main__:[step 35] model checkpoint saved
INFO:__main__:Evaluating [step 35] ...







INFO:__main__:Evaluated [step 35] rewards = 0.7085                                                                                               | 6/250 [01:26<1:06:13, 16.29s/it]
INFO:__main__:Best ckpt updated to [step 35]




 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 40/50 [35:35<07:05, 42.56s/it]INFO:__main__:[step 40] model checkpoint saved
INFO:__main__:Evaluating [step 40] ...







INFO:__main__:Evaluated [step 40] rewards = 0.7103                                                                                               | 6/250 [01:23<1:03:39, 15.65s/it]
INFO:__main__:Best ckpt updated to [step 40]




 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 45/50 [40:20<03:37, 43.58s/it]INFO:__main__:[step 45] model checkpoint saved
INFO:__main__:Evaluating [step 45] ...






INFO:__main__:Evaluated [step 45] rewards = 0.7085                                                                                               | 6/250 [01:24<1:05:07, 16.01s/it]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [44:29<00:00, 53.40s/it]